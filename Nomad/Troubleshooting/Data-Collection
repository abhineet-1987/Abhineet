# To check nomad server details
nomad server members
nomad operator raft list-peers

# To check nomad client details
nomad node status
nomad node status -verbose
nomad node status 8c7e3b79

# To check nommad agent details
nomad agent-info
nomad agent-info -json

nomad monitor -log-level=debug
nomad monitor -log-level=DEBUG -node-id=6bdc70fe      # -node-id: Specifies the client node-id to stream logs from
nomad monitor -log-level=DEBUG -server-id=nomad-server-1.global  # -server-id: Specifies the nomad server id to stream logs from


# You can ask for below configuration
Server Config
Client Config
Job spec (Helpful for reproduction)
allocation log (Needed for troubleshooting Autoscaler and CSI)
audit log (optional) -> Enterprise feature

# Nomad debug bundle
nomad operator debug -duration=10m -log-level=TRACE -server-id=all -node-id=all 2>&1 > t.txt
nomad operator debug -duration=10m -log-level=TRACE -server-id=all -node-id=all 2>&1 | tee debug_output.txt

# HCdiag ------------------------------------------------------
curl https://releases.hashicorp.com/hcdiag/0.5.2/hcdiag_0.5.2_linux_amd64.zip -o hcdiag.zip
unzip hcdiag.zip
export PATH=$PWD:$PATH

Set environment variables:
Before running hcdiag make sure all needed environment variables are set.

export CONSUL_HTTP_ADDR=  - set to the address to the local Consul agent.
export CONSUL_HTTP_TOKEN= - must be set to the API access token if ACLs are enabled.
export NOMAD_ADDR=        - set to the address of the Nomad server.
export NOMAD_TOKEN=       - must be set if ACLs are enabled.
export VAULT_ADDR=        - set to the address of the Vault server.
export VAULT_TOKEN=       - must be set to the Vault authentication token.

Running the hcdiag:
hcdiag run -consul -nomad -vault 2>&1 | tee hcdiag_output.txt
-----------------------------------------------------------

# Other general command for Metrics around CPU and memory utilization:-
CPU - vmstat, cloud provider metrics for "CPU %"
Memory - free -h, cloud provider metrics for “memory”
IO - iostat, sar -d, cloud provider metrics for "volume write/read ops" and "burst balance"
Network - sar -n, netstat -s, cloud provider metrics for interface "allowance"


# Jobs related
nomad job status 
nomad job status tetris
nomad job plan job.hcl
nomad job run job.hcl

# Alloc related
nomad alloc status dc571f50  (you'll get alloc id from "nomad job status hello-world" )
nomad alloc logs -f <alloc-id>


# Evaluation related
nomad eval list -job hello-world
nomad eval status dc95313f

# Container logs
sudo docker ps -a
sudo docker logs -f <ctr-id> -t

# Nomad event stream
curl -s -v -N http://127.0.0.1:4646/v1/event/stream | jq
