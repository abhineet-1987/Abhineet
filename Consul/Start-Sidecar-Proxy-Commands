consul connect proxy -sidecar-for client1        #client1 is the id of the service defined in service definition file
nohup consul connect proxy -sidecar-for client1 > web-sidecar.log 2>&1 &      #to run sidecar proxy in backend
#Please note that if you run above command with output file redirected in /etc/consul.d folder, you may get issue and proxy may not start, hence you may change the path

#To start Envoy sidecar proxy:
consul connect envoy -token=${CONSUL_HTTP_TOKEN} -envoy-binary /usr/local/bin/envoy -sidecar-for client1 > /tmp/sidecar-proxy.log 2>&1 &
consul connect envoy \
   -token=${CONSUL_HTTP_TOKEN} \
  -envoy-binary /usr/local/bin/envoy \
  -sidecar-for client1 > /tmp/sidecar-proxy.log 2>&1 &


#To register services:
consul services register service-file.hcl

######## Important Concepts ############
How does Consul know to use Envoy instead of the built-in proxy?
Consul determines the proxy type based on how you launch the sidecar.

For eg :-
consul connect proxy -sidecar-for client1     # You use Consul built in proxy to run the sidecar service.
consul connect envoy -sidecar-for client1     # You run the Envoy proxy manually to run the sidecar service.
